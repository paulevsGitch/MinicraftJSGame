const Minicraft={};Minicraft.renderContext={},Minicraft.loaded=!1,Minicraft.inWorld=!1,Minicraft.initGame=function(){Minicraft.screen=new MainMenuScreen;let a=Minicraft.renderContext;a.canvas=document.getElementById("canvas"),a.context=canvas.getContext("2d"),a.center=new Vec2,a.delta=0,a.lightmap={},a.lightmap.canvas=document.createElement("canvas"),a.lightmap.context=a.lightmap.canvas.getContext("2d"),a.camera={position:new Vec2,movement:new Vec2,target:void 0,zoomDelta:0,zoomNext:4,zoomPrev:4,zoom:4},a.fps={sumDelta:0,avDelta:0,avFPS:0,ticks:0,time:8},Images.afterLoad(()=>{Minicraft.loaded=!0,Minicraft.onResize(),a.time=Date.now(),window.requestAnimationFrame(Minicraft.globalRender)})},Minicraft.onResize=function(){if(!Minicraft.loaded)return;let a=Minicraft.renderContext.canvas;a.width=window.innerWidth,a.height=window.innerHeight,Minicraft.renderContext.center.set(a.width>>1,a.height>>1),Minicraft.screen.onResize(Minicraft.renderContext.center,a.width,a.height),(a=Minicraft.renderContext.lightmap.canvas).width=window.innerWidth,a.height=window.innerHeight};var but=GUI.makeDefaultButton("TEXT",null);Minicraft.globalRender=function(){let a=Minicraft.renderContext;a.context.clearRect(0,0,a.canvas.width,a.canvas.height),Minicraft.updateZoom(a),Minicraft.screen.onTick(),Minicraft.screen.render(a),Minicraft.updateFPS(a),Minicraft.drawFPS(a),Minicraft.updateTime(a),window.requestAnimationFrame(Minicraft.globalRender)},Minicraft.drawFPS=function(a){Render.setFont(a.context),a.context.fillStyle="black",a.context.fillText("FPS: "+a.fps.avFPS,20,66),a.context.fillText("Delta: "+a.fps.avDelta,20,90),a.context.fillStyle="white",a.context.fillText("FPS: "+a.fps.avFPS,20,64),a.context.fillText("Delta: "+a.fps.avDelta,20,88)},Minicraft.updateFPS=function(b){let a=b.fps;a.sumDelta+=b.delta,a.ticks===a.time&&(a.avDelta=(a.sumDelta/a.time).toFixed(3),a.avFPS=(a.time/a.sumDelta).toFixed(0),a.sumDelta=0,a.ticks=0),a.ticks++},Minicraft.updateTime=function(a){let b=Date.now();a.delta=(b-a.time)*.001,a.time=b},Minicraft.updateZoom=function(b){if(!Minicraft.inWorld)return;let a=b.camera;a.zoomNext!=a.zoomPrev&&(a.zoomDelta+=10*b.delta,a.zoomDelta>1&&(a.zoomDelta=1),a.zoom=MathHelper.lerp(a.zoomPrev,a.zoomNext,a.zoomDelta))},Minicraft.changeZoom=function(b){if(!Minicraft.inWorld)return;let a=Minicraft.renderContext.camera;a.zoomPrev=a.zoom,a.zoomNext=MathHelper.clamp(a.zoomNext+b,1,8),a.zoomDelta=0}